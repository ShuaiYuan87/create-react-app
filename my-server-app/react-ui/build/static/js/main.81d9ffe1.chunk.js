(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t){var a=Object.freeze({PLAY:1,PAUSE:2,SEEK:3,STOP:4,RELOAD:5,CHAT:6});e.exports=a},108:function(e,t,a){!function(e){e.MsgType=Object.freeze({CHECK_LATENCY:1,REQUEST:2,ACK:3,ACTION:4})}(t)},141:function(e,t){},145:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(38),s=a.n(i),r=(a(82),a(10)),c=a(9),l=a(12),u=a(11),d=a(13),p=a(2),h=(a(84),a(44),a(65)),g=a.n(h),m=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"message"},this.props.text,o.a.createElement("div",{className:"arrow"}),o.a.createElement("img",{className:"head",alt:"avatar",src:"http://graph.facebook.com/"+this.props.userid+"/picture?type=square"}))}}]),t}(o.a.Component),f=a(14),y=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement(f.TransitionMotion,{defaultStyles:this.getDefaultValue(),styles:this.getEndValue(),willLeave:this.willLeave,willEnter:this.willEnter},function(e){return o.a.createElement("div",{className:"chatpane"},e.map(function(e){e.key;var t=e.style,a=e.data;return o.a.createElement("div",{style:t}," ",a,"  ")}))})}},{key:"getEndValue",value:function(){for(var e=[],t=this.props.children.length,a=Math.max(t-5,0),n=a;n<t;n++)e[n-a]={key:n.toString(),data:this.props.children[n],style:{width:Object(f.spring)(300,f.presets.gentle),opacity:Object(f.spring)(1,f.presets.gentle)}};return e}},{key:"getDefaultValue",value:function(){return[]}},{key:"willEnter",value:function(){return{width:0,opacity:1}}},{key:"willLeave",value:function(){return{width:Object(f.spring)(0),opacity:Object(f.spring)(0)}}}]),t}(o.a.Component),v=a(107),b=a(108),k=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={url:null,playing:a.props.playing,volume:.8,muted:!1,played:0,loaded:0,duration:0,playbackRate:1,loop:!1,opaque:!1,modalIsOpen:!1,init:!1,initiate:!0,text:"",chatheads:[]},a.onPlay=function(){if(a.state.initiate){console.log("onPlay"),a.setState({playing:!0});var e=a.createMessage(!1,a.props.rid,0,v.PLAY);a.props.socket.emit("postData",JSON.stringify(e))}else a.setState({initiate:!0})},a.onPause=function(){if(a.state.initiate){console.log("onPause"),a.setState({playing:!1});var e=a.createMessage(!1,a.props.rid,0,v.PAUSE);a.props.socket.emit("postData",JSON.stringify(e))}else a.setState({initiate:!0})},a.checkRecieve=function(e){var t=JSON.parse(e.message);console.log(t);var n=a.player.getCurrentTime();a.props.socket.emit("init",JSON.stringify(a.createMessage(!1,a.props.rid,n,v.RELOAD,a.state.url)))},a.ref=function(e){a.player=e,console.log(a.player)},a.onSeekMouseDown=function(e){a.setState({seeking:!0})},a.onSeekChange=function(e){a.setState({played:parseFloat(e.target.value)})},a.onSeekMouseUp=function(e){a.setState({seeking:!1});var t=parseFloat(e.target.value),n=a.createMessage(!1,a.props.rid,t*a.state.duration,v.SEEK);a.props.socket.emit("postData",JSON.stringify(n)),a.player.seekTo(t)},a.onProgress=function(e){a.state.seeking||a.setState(e)},a.onDuration=function(e){console.log("onDuration",e),a.setState({duration:e})},a.playPause=function(){a.setState({playing:!a.state.playing})},a.over=a.over.bind(Object(p.a)(Object(p.a)(a))),a.out=a.out.bind(Object(p.a)(Object(p.a)(a))),a.onstart=a.onstart.bind(Object(p.a)(Object(p.a)(a))),a.messageRecieve=a.messageRecieve.bind(Object(p.a)(Object(p.a)(a))),a.checkRecieve=a.checkRecieve.bind(Object(p.a)(Object(p.a)(a))),a.initRecieve=a.initRecieve.bind(Object(p.a)(Object(p.a)(a))),a.reloadRecieve=a.reloadRecieve.bind(Object(p.a)(Object(p.a)(a))),a._add=a._add.bind(Object(p.a)(Object(p.a)(a))),a._addMessage=a._addMessage.bind(Object(p.a)(Object(p.a)(a))),a.state.init=a.props.init,a.state.url=a.props.url,console.log("constructor"),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"onstart",value:function(){console.log("onstart")}},{key:"render",value:function(){var e=this,t=this.state,a=(t.url,t.playing),n=(t.volume,t.muted,t.loop,t.played),i=(t.loaded,t.duration,t.playbackRate,window.innerWidth*this.props.portion),s=window.innerHeight*this.props.portion;return o.a.createElement("div",null,o.a.createElement(y,null,this.state.chatheads),o.a.createElement("tr",null,o.a.createElement("th",null,"Seek"),o.a.createElement("td",null,o.a.createElement("input",{type:"range",min:0,max:1,style:{width:i-285},step:"any",value:n,onMouseDown:this.onSeekMouseDown,onChange:this.onSeekChange,onMouseUp:this.onSeekMouseUp})),o.a.createElement("th",null,o.a.createElement("button",{onClick:function(){e.sendChat(e.state.text),e._addMessage(e.state.text,e.props.userid),e.setState({text:""})}},"Chat")),o.a.createElement("td",null,o.a.createElement("input",{type:"text",style:{width:200},value:this.state.text,onChange:function(t){return e.setState({text:t.target.value})},onKeyDown:function(t){return e._add(t)}}))),o.a.createElement("div",{style:{width:i,height:s,display:"inline-block"},className:this.state.opaque?"opaque":"",onMouseOver:this.over,onMouseOut:this.out},o.a.createElement(g.a,{ref:this.ref,url:this.state.url,width:"100%",height:"100%",playing:a,onPlay:this.onPlay,onPause:this.onPause,onReady:function(){return console.log("onReady")},config:{vimeo:{playerOptions:{byline:!1}},dailymotion:{params:{controls:1}},facebook:{appId:"106676343020606"}},onStart:this.onstart,onProgress:this.onProgress,onDuration:this.onDuration})))}},{key:"out",value:function(e){this.setState({opaque:!1})}},{key:"over",value:function(e){this.setState({opaque:!0})}},{key:"_add",value:function(e){13===e.keyCode&&(this.sendChat(this.state.text),this._addMessage(this.state.text,this.props.userid),this.setState({text:""}))}},{key:"_addMessage",value:function(e,t){var a=this.state.chatheads;a.push(o.a.createElement(m,{text:e,userid:t})),this.setState({chatheads:a})}}]),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.init||this.props.socket.emit("create",this.props.room),this.props.socket.on("notification",this.messageRecieve),this.props.socket.on("check_state",this.checkRecieve),this.props.socket.on("init",this.initRecieve),this.props.socket.on("reload",this.reloadRecieve),console.log("componentDidMount")}},{key:"reload",value:function(e){console.log(e);var t=this.createMessage(!1,this.props.rid,0,v.RELOAD,this.props.url);this.props.socket.emit("reload",JSON.stringify(t)),this.loadVideo(e)}},{key:"sendChat",value:function(e){var t=this.createMessage(!1,this.props.rid,0,v.CHAT,this.props.userid);t.text=e,this.props.socket.emit("postData",JSON.stringify(t))}},{key:"componentDidUpdate",value:function(e){}},{key:"createMessage",value:function(e,t,a,n,o){console.log("createMessage");var i={clientTime:Date.now()/1e3,clientId:t,playerTime:a,playerAction:n,videoId:o,roomId:this.props.room};return e?(i.ackMsgID=e,i.msgType=b.MsgType.ACK):i.msgType=b.MsgType.REQUEST,console.log(i),i}},{key:"messageRecieve",value:function(e){if(e=JSON.parse(e.message),parseInt(e.clientId)!==this.props.rid)switch(console.log(e),e.msgType){case b.MsgType.CHECK_LATENCY:this.props.socket.emit("postData",JSON.stringify(this.createMessage(!0,this.props.rid)));break;case b.MsgType.ACTION:this.applyActionToPlayer(e)}}},{key:"initRecieve",value:function(e){this.state.init||(e=JSON.parse(e.message),console.log(e),this.applyActionToPlayer(e),this.setState({init:!0}))}},{key:"reloadRecieve",value:function(e){e=JSON.parse(e.message),console.log(e),parseInt(e.clientId)!==this.props.rid&&this.loadVideo(e.videoId)}},{key:"loadVideo",value:function(e){this.setState({url:e})}},{key:"applyActionToPlayer",value:function(e){switch(e.playerAction){case v.PLAY:this.setState({initiate:!1}),this.state.playing||this.setState({playing:!0}),0!==e.playerTime&&this.player.seekTo(e.playerTime);break;case v.PAUSE:this.setState({initiate:!1}),this.state.playing&&this.setState({playing:!1}),0!==e.playerTime&&this.player.seekTo(e.playerTime);break;case v.SEEK:this.player.seekTo(e.playerTime);break;case v.RELOAD:console.log(e.videoId),this.loadVideo(e.videoId),0!==e.playerTime&&(this.setState({playing:!0}),this.player.seekTo(e.playerTime));break;case v.CHAT:this._addMessage(e.text,e.videoId)}}}]),t}(o.a.Component),O=a(39),E=a.n(O),w=a(148),S=a(150),j=a(149),M=a(147),R=a(66),T=a.n(R),C=a(67),I=a.n(C),x=a(68),N=a.n(x),L=a(69),A=a.n(L),D=a(70),P=a.n(D),U=a(71),J=a.n(U),_=a(72),K=a.n(_),B=Math.floor(1e5*Math.random()),V="room"+Math.floor(1e5*Math.random()),q=K.a.connect(),H=!1,W={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}};E.a.setAppElement("#root");var F=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={modalIsOpen:!1,url:"https://www.youtube.com/watch?v=oUFJJNQGwhk",text:"",chatheads:[],roomURL:"",player:null,userid:null},a.openModal=a.openModal.bind(Object(p.a)(Object(p.a)(a))),a.afterOpenModal=a.afterOpenModal.bind(Object(p.a)(Object(p.a)(a))),a.closeModal=a.closeModal.bind(Object(p.a)(Object(p.a)(a))),a.setURL=a.setURL.bind(Object(p.a)(Object(p.a)(a))),a.myRef=o.a.createRef(),a.updateLoggedInState=a.updateLoggedInState.bind(Object(p.a)(Object(p.a)(a))),a.updateLoggedOutState=a.updateLoggedOutState.bind(Object(p.a)(Object(p.a)(a))),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"openModal",value:function(e,t,a){this.setState({modalIsOpen:!0}),this.setState({url:e}),this.setState({roomURL:"/"+t}),console.log("openModal"),console.log(a),this.setState({player:a})}},{key:"afterOpenModal",value:function(){this.subtitle.style.color="#f00"}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1});var e=document.createElement("input"),t=window.location.href;document.body.appendChild(e),e.value=t,e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("Link "+t+" copied to clickboard, now share it with friends!")}},{key:"setURL",value:function(e){this.setState({url:e})}},{key:"doNothing",value:function(){}},{key:"updateLoggedInState",value:function(e){this.setState({userid:e.authResponse.userID}),console.log(this.state.userid)}},{key:"updateLoggedOutState",value:function(){console.log("updateLoggedOutState")}},{key:"componentDidMount",value:function(){window.fbAsyncInit=function(){var e=this;window.FB.init({appId:"1204292072921486",cookie:!0,xfbml:!0,version:"v3.2"}),window.FB.getLoginStatus(function(e){}),window.FB.Event.subscribe("auth.statusChange",function(t){t.authResponse?e.updateLoggedInState(t):e.updateLoggedOutState()})}.bind(this),function(e,t,a){var n,o=e.getElementsByTagName(t)[0];e.getElementById(a)||((n=e.createElement(t)).id=a,n.src="https://connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(n,o))}(document,"script","facebook-jssdk")}},{key:"render",value:function(){var e=this;return o.a.createElement(w.a,null,o.a.createElement("div",{className:"App"},o.a.createElement("div",null,o.a.createElement(E.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,style:W,contentLabel:"Example Modal"},o.a.createElement("h2",{ref:function(t){return e.subtitle=t}},"Share with others to start watching together!"),o.a.createElement("button",{onClick:this.closeModal},"copy url to clipboard"),o.a.createElement("div",null,"I am a modal"))),o.a.createElement("div",{id:"hero",className:"Hero",style:{backgroundImage:"url("+T.a+")"}},o.a.createElement("div",{className:"content"},o.a.createElement("img",{className:"logo",src:I.a,alt:"narcos background"}),o.a.createElement("div",{className:"fb-login-button","data-max-rows":"1","data-size":"medium","data-button-type":"continue_with","data-show-faces":"true","data-auto-logout-link":"true","data-use-continue-as":"true"}),o.a.createElement("p",null),o.a.createElement("h2",null,"Welcome to KeeKon, an experience lets you and your remote friends watch videos together!"),o.a.createElement("p",null),o.a.createElement("h3",null,"Paste below the video link you and your friends would like to watch."),o.a.createElement("p",null),o.a.createElement("input",{type:"text",style:{width:300},value:this.state.url,onChange:function(t){e.setState({url:t.target.value})},onKeyDown:function(t){13===t.keyCode&&(e.myRef.current.reload(t.target.value),e.setState({modalIsOpen:!0}))}}),o.a.createElement("button",{className:"button",onClick:function(){e.myRef.current.reload(e.state.url),e.setState({modalIsOpen:!0})}},"go"),o.a.createElement("p",null),o.a.createElement("div",{id:"logos"},o.a.createElement("img",{src:N.a,style:{width:60,height:40},alt:"youtube logo"}),o.a.createElement("img",{src:A.a,style:{width:60,height:40},alt:"facebook logo"}),o.a.createElement("img",{src:P.a,style:{width:60,height:40},alt:"vimeo logo"}),o.a.createElement("img",{src:J.a,style:{width:60,height:40},alt:"dailymotion logo"})))),o.a.createElement(S.a,null,o.a.createElement(j.a,{exact:!0,path:"/",render:function(){return H=!0,q.emit("create",V),o.a.createElement("div",null,o.a.createElement(M.a,{to:V}))}}),o.a.createElement(j.a,{path:"/:roomID",render:function(t){var a=t.match;return o.a.createElement("div",null,o.a.createElement(k,{ref:e.myRef,url:e.state.url,portion:"1",openModal:e.doNothing.bind(e),playing:!1,room:a.params.roomID,socket:q,rid:B,init:H,userid:e.state.userid}))}}))))}}]),t}(n.Component),Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Q(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}s.a.render(o.a.createElement(F,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");Y?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Q(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Q(e)})}}()},44:function(e,t,a){},66:function(e,t,a){e.exports=a.p+"static/media/633643.f0fbf363.jpg"},67:function(e,t,a){e.exports=a.p+"static/media/narcos.logo.5d0f7fbb.png"},68:function(e,t,a){e.exports=a.p+"static/media/YouTube.9e04b2f1.jpg"},69:function(e,t,a){e.exports=a.p+"static/media/facebook.02e4dc07.jpg"},70:function(e,t,a){e.exports=a.p+"static/media/vimeo.ec7e4fdb.jpg"},71:function(e,t,a){e.exports=a.p+"static/media/dailymotion.71101c1d.jpg"},73:function(e,t,a){e.exports=a(145)},82:function(e,t,a){},84:function(e,t,a){}},[[73,2,1]]]);
//# sourceMappingURL=main.81d9ffe1.chunk.js.map